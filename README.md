### 0x01 漏洞描述

​		禅道项目管理系统存在身份认证绕过漏洞，远程攻击者利用该漏洞可以绕过身份认证，调用任意API接口并修改管理员用户的密码，并以管理员用户登录该系统，配合其他漏洞进一步利用后，可以实现完全接管服务器。



### 0x02 漏洞影响版本

	16.0 <= 禅道项目管理系统 <=18.11（开源版）
	6.0  <= 禅道项目管理系统 <=8.11 （企业版）
	3.0  <= 禅道项目管理系统 <=4.11（旗舰版）



### 0x03 漏洞环境

> hunter语法

```shell
app.name="ZenTao 禅道"
```

![image-20240428210208452](typora-img/README/image-20240428210208452.png)



### 0x04 漏洞复现

首先我们通过访问下面的接口可以获取到一个Set-Cookie

![image-20240428210437571](typora-img/README/image-20240428210437571.png)



我们可以使用拿到的Cookie值去进行其他操作，如下面的接口可以进行管理员账户的创建，部分响应状态码是403，但并不影响账户创建。

![image-20240428210657969](typora-img/README/image-20240428210657969.png)



### 0x05 漏洞修复建议

​		目前禅道官方已正式发布修复版本, 建议受影响用户尽快升级至安全版本。如不能升级，可在module/common/model.php文件中的echo $endResponseException->getContent();后面加上exit(); 来修复权限绕过漏洞。



### 0x06 工具

漏洞利用工具，支持单个扫描、批量扫描等等

![image-20240428211317424](typora-img/README/image-20240428211317424.png)

可以创建开源版、企业版、旗舰版用户

![image-20240428211619867](typora-img/README/image-20240428211619867.png)

![image-20240428213649824](typora-img/README/image-20240428213649824.png)
